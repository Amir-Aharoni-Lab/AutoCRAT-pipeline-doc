# ScreenByRepTime Script Documentation

<iframe src="../assets/ScreenByRepTime_diagram.html" width="800" height="300" style="border:none; margin:0; padding:0; display:block;"></iframe>
The **ScreenByRepTime** script screens cells from the replication summary file generated by AutoCRAT. It filters cells based on their replication time, allowing for the identification of cells that replicate early or late in the experiment. It is particularly useful for experiments where damage or treatment before replication is being studied, as it ensures only relevant cells are analyzed.

---

## Key Tasks

### &nbsp;&nbsp;- Read Input Files
- Reads the **'Rep Summary'** file and, if available, includes the **'RNSA'** file from an AutoCRAT run.

### &nbsp;&nbsp;- Screen Cells by Replication Time
- Filters cells based on a specified **replication time threshold** (`rep_time_threshold`):
  - **Under Mode:** Retains cell where replication occurs *before* the threshold and discards those replicating *at or after* the threshold.
  - **Over Mode:** Retains cell where replication occurs *after* the threshold and discards those replicating *at or before* the threshold.

### &nbsp;&nbsp;- Generate Updated Files
- Creates a new '**Rep Summary**' file and optionally generates an '**RNSA**' file if it was provided. Cells beyond the threshold are excluded.

---

## How to Use ScreenByRepTime

### Step 1: Edit Parameters in the Script

#### &nbsp;&nbsp;• Specify the Rep Summary File Location
Define the folder and filename of the **Rep Summary** file. The RNSA file can optionally be included in the same folder. If both are provided, the output will reflect both files:
```python
folder = r'path_to_your_folder'
rep_summary_filename = 'your_rep_summary_file.xlsx'
```

#### &nbsp;&nbsp;• Set the Screening Threshold
Define the replication time threshold and the filtering mode:<br>
- **Threshold Timepoint:** Timepoint beyond which cells are filtered (`rep_time_threshold`).<br>
- **Mode:** `'Under'` or `'Over'` to specify which cells to retain. Choose `'Under'` to keep cells replicating earlier than the threshold or `'Over'` to keep cells replicating later than the threshold.
```python
rep_time_threshold = 100
under_over = 'Under'
```

#### &nbsp;&nbsp;• Configure Summary Chart Parameters
Set the appearance of the RNSA summary chart:
```python
colors = ['red', 'orange', 'lime']  # Chart colors
rnsa_x_axis = [-2, 3]               # X-axis range
rnsa_y_axis = [0.1, 0.8]            # Y-axis range
```

---

### Step 2: Run the Script
After editing the parameters:<br>
• Save the script.<br>
• Run the script in your Python environment (e.g., command line, Jupyter Notebook, or PyCharm).

---

### Step 3: Output Files
The script generates the following output files in the same folder as the original Rep Summary file: <br>
&nbsp;&nbsp;• ```your_rep_summary_file - Screened (Rep time under/over X).xlsx```
   - Summarizes cells that meet the replication time criteria. <br>
&nbsp;&nbsp;• ```your_rep_summary_file - RNSA - Screened (Rep time under/over X).xlsx```
   - Contains RNSA data for cells that passed the replication time screening.

---

## Example Configuration
Below is a sample configuration to screen out cells with replication times greater than 100 minutes, keeping only cells that replicate earlier:

```python
""" Parameters """

# Location and filename of the "Rep Summary" file to be screened.
# If there is an AutoCRAT "RNSA" file in the same folder and with an identical name
# (except with "RNSA" instead of "Rep Summary"), it will also undergo screening.
folder = r'C:\Project\Merged_Results'
rep_summary_filename = 'Merged_Project_Results - Rep Summary.xlsx'

# Threshold timepoint beyond which cells will be screened.
rep_time_threshold = 100

# Select which cells to *keep*.
# If 'Under', cells in which all arrays are replicated before the above threshold
# will be kept, cells in which at least one array is replicated at or after the
# threshold will be discarded.
# If 'Over', cells in which all arrays are replicated after the threshold will be
# kept.
under_over = 'under'

# Parameters for RNSA summary chart.
colors = ['red', 'orange', 'lime']
rnsa_x_axis = [-2, 3]
rnsa_y_axis = [0.1, 0.8]
```

### Example Output
- `C:\Project\Merged_Results\Merged_Project_Results - Rep Summary - Screened (Rep time under 100).xlsx`
- `C:\Project\Merged_Results\Merged_Project_Results - RNSA - Screened (Rep time under 100).xlsx`

---

By following these steps, you can efficiently filter cells based on replication time, ensuring that only early or late replicating cells are retained for further analysis.